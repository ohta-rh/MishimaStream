// Generated by CoffeeScript 1.3.3
(function() {
  var IndexView, ctx, draw, view;

  ctx = null;

  draw = null;

  IndexView = Backbone.View.extend({
    el: $("#canvas"),
    initialize: function() {
      ctx = this.el.getContext('2d');
      ctx.lineJoin = 'round';
      ctx.lineCap = 'round';
      ctx.lineWidth = 15;
      ctx.strokeStyle = '#fff';
      ctx.globalAlpha = 0;
      draw = false;
      this.socket = io.connect("http://192.168.0.118:3004");
      this.socket.on("connect");
      this.socket.on("startdraw", this.startDraw);
      this.socket.on("drawing", this.drawing);
      this.socket.on("enddraw", this.endDraw);
      return true;
    },
    events: {
      "mousedown": "emit1",
      "mousemove": "emit2",
      "mouseup": "emit3"
    },
    emit1: function(event) {
      return this.socket.emit("emit1", {
        x: event.layerX,
        y: event.layerY
      });
    },
    emit2: function(event) {
      return this.socket.emit("emit2", {
        x: event.layerX,
        y: event.layerY
      });
    },
    emit3: function(event) {
      return this.socket.emit("emit3", {});
    },
    startDraw: function(event) {
      ctx.beginPath();
      ctx.moveTo(event.x, event.y);
      return draw = true;
    },
    drawing: function(event) {
      if (draw) {
        ctx.lineTo(event.x, event.y);
        return ctx.stroke();
      }
    },
    endDraw: function(event) {
      if (draw) {
        ctx.closePath();
        return draw = false;
      }
    },
    hoge: function() {
      return alert('hoge');
    }
  });

  view = new IndexView();

}).call(this);
